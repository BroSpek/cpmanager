(()=>{const e="cpm-cache-v0.1.1",n=["index.html","icons/icon-192x192.png","icons/icon-512x512.png"];self.addEventListener("install",(t=>{console.log(`Service Worker: Installing ${e}...`),t.waitUntil(caches.open(e).then((t=>(console.log(`Service Worker: Caching app shell into ${e}`),t.addAll(n)))).then((()=>(console.log(`Service Worker: App shell for ${e} cached successfully`),self.skipWaiting()))).catch((n=>{console.error(`Service Worker: Caching for ${e} failed`,n)})))})),self.addEventListener("activate",(n=>{console.log(`Service Worker: Activating ${e}...`);const t=[e];n.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(-1===t.indexOf(e))return console.log(`Service Worker: Deleting old cache: ${e}`),caches.delete(e)}))))).then((()=>(console.log(`Service Worker: Activated (${e}) and old caches cleaned.`),self.clients.claim()))))})),self.addEventListener("fetch",(n=>{"GET"===n.request.method&&n.respondWith(caches.open(e).then((e=>e.match(n.request).then((e=>e||fetch(n.request).then((e=>e)))))).catch((e=>{console.error("Service Worker: Fetch failed or cache open failed.",e)})))})),self.addEventListener("message",(e=>{if(e.data&&"SHOW_NOTIFICATION"===e.data.type){const{title:n,body:t,icon:i,id:o}=e.data.payload;e.waitUntil(self.registration.showNotification(n,{body:t,icon:i||"icons/icon-192x192.png",badge:"icons/badge-icon.png",tag:`new-user-signin-${o||(new Date).getTime()}`}))}})),self.addEventListener("notificationclick",(e=>{e.notification.close();const n=new URL("index.html#sessions",self.registration.scope).href;e.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{for(const t of e)if(t.url.startsWith(self.registration.scope)&&"focus"in t)return t.navigate(n),t.focus();if(self.clients.openWindow)return self.clients.openWindow(n)})))}))})();
//# sourceMappingURL=sw.dffdd69bc7004d9fd48c.js.map